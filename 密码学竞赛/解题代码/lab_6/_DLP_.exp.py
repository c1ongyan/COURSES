from sympy.ntheory.modular import crt
import sympy

def PH(g,h,p):
    fac=[5,263,587,28142457071,395710839697]
    Lg=[pow(g,(p-1)//i,p) for i in fac]
    Lh=[pow(h,(p-1)//i,p) for i in fac]
    length=len(fac)
    La=[]
    for i in range(length):
        m=sympy.discrete_log(p,Lh[i],Lg[i])
        La.append(m)
        #print(m)
    res,mod=crt(fac,La)
    return res

p=135413548968824157679549005083702144352234347621794899960854103942091470496598900341162814164511690126111049767046340801124977369460415208157716471020260549912068072662740722359869775486486528791641600354017790255320219623493658736576842207668208174964413000049133934516641398518703502709055912644416582457721
g=696376465415968446607383675953857997
h=75351884040606337127662457946455960228423443937677603718170904462378938882502061014476822055783421908392386804380503123596242003758891619926133807099465797120624009076182390781918339985157326114840926784410018674639537246981505937318380179042568501449024366208980139650052067021073343322300422190243015076307
result=PH(g,h,p)
print(result)
#17271504622210389511
