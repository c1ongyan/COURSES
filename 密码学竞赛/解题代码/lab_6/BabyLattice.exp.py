from Crypto.Util.number import *
import gmpy2 as gp
e=0x10001
n= 54147937924071750685132589597661237441727788988868736194629668020894970449517024349835139649000427166690895104817725505539019661437151318603603509202411060287100419586954922875720947457740412444734150747083066539141855393070652131365391731433911991338026482617419705006546847163644460891667186364712343137058379864410555108744766803472524522798841
r= 526617682578812332472499599928388278143503289386649081518089209212839269711149657644560690243631848784155273059079763655306322037860343713555955557776301731250899315302339393017461896607764032214566450629518828318345652512291687272029451981698790250235499813302864603716052831568705584986298112493213438072092111788038578178537995772635076133138844603002390903892034893181473091486101591874104776017392084708494972552697335872392596912172011101168908509885286589852779726008251965647678380547807785004760606318002879664935601453820069835904665846794194446329111581005768906313105140531996107701715361619683965489109897759272661709802416562290471900426725295324955849255809648906189119798665389780450322335801389715650151016278038322604260670399208247689144341288814018229897288542538079161097605529299105239651236452277856135069331660151170167422702944418850548259361715726639656451109120221176604689394115115693703015829030458186184854721867503042936247425888815237531920259167461133319238722598853166641667726905063497888558144009559720191771450498857395719911899963766513219733727924728463661010647298484246231686035964189846094515779983099576625481831344806867029436795303748086224605574500577434632623316909918204753001315419253
gift= 298843819220699266990955037079251721362975742562108372945386963615132792135268829155374288343532987247513184952707840953727238175393216743966869344819382654650900006470609147699508001405112750343398664189312760330789154576504963132108960709116837334996855923027295771614124709958996729062531142263495204423685112741196669676660820749743559974583180110880600764589705083833198068405616453063770777865125345095614142627663550023436317082201927387020013521232841988272843115170495917404619331733363202261151089887986797176719701760258996618079747550363222475699641297289315778676207941657411367604097999814375984660978383076961212934900375902222294888946584408196038819580145062695391078822160341518163302082180887852483347915279746006739177796058299904124194706813135486622596191058927566760235490140172132688495809866296700595943220793157419256796149603250183654614238063791757432419936533631472385728875027206450124328231836139937381277010514880956400758905529150599509173125487301144192680705272258245495118964539568980036988457109448594632950636035338397827763526085223546417184663835654329453808288014619625459719174160346122515035637957051447071798867459984184615050440149098942589438522299453341415128289973622114329036747297693
c= 43046582723003016855257740025008592150556455550916587310976439591736419073057629831927313125132461852910784498607809910944404577870359589643275930778267851028980457697323559276509158439044420456395600627746780205225619484583837242619680444799774336060214162310658382333183816482398452733559304351388588897836738285510083842459735805455715379259108
delta= 1090929714383962070477735142607
x= 316595353593601549461214538987753809142
p=x+bytes_to_long(b'BabyLattice')
#p=(delta*gift)%r+bytes_to_long(b'BabyLattice')
q=n//p
phi=(q-1)*(p-1)
d=gp.invert(e,phi)
m=pow(c,d,n)
flag=long_to_bytes(m)
print(flag)

