from sympy.ntheory.modular import crt
import sympy

def PH(g,h,p):
    fac=[5,263,587,28142457071,395710839697]
    Lg=[pow(g,(p-1)//i,p) for i in fac]
    Lh=[pow(h,(p-1)//i,p) for i in fac]
    length=len(fac)
    La=[]
    for i in range(length):
        m=sympy.discrete_log(p,Lh[i],Lg[i])
        La.append(m)
        #print(m)
    res,mod=crt(fac,La)
    return res

p=135413548968824157679549005083702144352234347621794899960854103942091470496598900341162814164511690126111049767046340801124977369460415208157716471020260549912068072662740722359869775486486528791641600354017790255320219623493658736576842207668208174964413000049133934516641398518703502709055912644416582457721
g=86058010920482240250386428671252846947337112911812123754576629247785642290091
h=41318946494679095834478681448121630001086130841852662720404726660963599574714625888075536763080767861967564628282819187513583578016599424899255261884460711377363184458056815695957899698623196649163025084549601980034261300843373884410349828848094416989357511761074392171444577468186199219977721684920814583821
result=PH(g,h,p)
print(result)
